{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Antonio Mallen Gimen/Documents/Proyecto/FrontAntonioMallen/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as shajs from 'sha.js';\nimport { FormControl, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"@angular/material/snack-bar\";\nimport * as i4 from \"../userService\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/form-field\";\nimport * as i7 from \"@angular/material/input\";\nimport * as i8 from \"@angular/forms\";\nfunction LoginComponent_mat_error_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r1.getErrorMessage());\n  }\n}\nfunction LoginComponent_mat_error_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r4.getErrorMessage());\n  }\n}\nexport class LoginComponent {\n  constructor(router, http, _snackBar, userService) {\n    this.router = router;\n    this.http = http;\n    this._snackBar = _snackBar;\n    this.userService = userService;\n    //users: User[]=[];\n    this.mensaje = \"\";\n    this.email = new FormControl('', [Validators.required, Validators.email]);\n    this.pulsadoLogin = false;\n    this.pulsadoRegister = false;\n    /*const req=this.http.get<User[]>('http://localhost:8080/usuarios/all')\r\n    req.subscribe(res=>{\r\n      this.users=res;\r\n    })*/\n  }\n\n  onLogin(email, password) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      var user = yield _this.getUser(email);\n      console.log(\"Desde el login\" + user);\n      _this.pulsadoLogin = true;\n      let mensaje = _this.getErrorMessage();\n      if (mensaje == '') {\n        if (email != \"\" && password != \"\") {\n          let aux = '';\n          console.log(user);\n          if (user) {\n            console.log(user.correo + \" \" + email + \" \" + aux);\n            if (user.correo == email && aux != 'ok' && aux != 'cn') {\n              var passwordEncrypted = _this.encryptar(password);\n              if (user.password == passwordEncrypted) {\n                aux = 'ok';\n              } else {\n                aux = 'cn';\n              }\n            } else {\n              aux = 'co';\n            }\n            if (aux == 'ok') {\n              document.getElementById(\"userName\").value = \"\";\n              document.getElementById(\"password\").value = \"\";\n              _this.userService.setUser(user);\n              _this.router.navigate(['/home']);\n            } else if (aux == 'cn') {\n              _this._snackBar.open(\"Contraseña incorrecta\", \"Cerrar\");\n            } else {\n              _this._snackBar.open(\"Correo no encontrado\", \"Cerrar\");\n            }\n            console.log(aux + \" \" + user);\n          }\n        } else {\n          _this._snackBar.open(\"Todos los campos deben ser rellenados\", \"Cerrar\");\n        }\n      }\n    })();\n  }\n  onRegister(email, username, password) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      var user = yield _this2.getUser(email);\n      console.log(user);\n      _this2.pulsadoRegister = true;\n      let mensaje = _this2.getErrorMessage();\n      if (mensaje == '') {\n        let guardado = false;\n        if (user) {\n          if (user.correo != null) {\n            guardado = true;\n          }\n        }\n        if (guardado == false) {\n          if (email != \"\" && username != \"\" && password != \"\") {\n            /*\r\n            var passwordEncrypted=this.encryptar(password);\r\n            let body={\r\n              \"nombre\": username,\r\n              \"correo\": email,\r\n              \"password\": passwordEncrypted,\r\n              \"reservas\": [],\r\n              \"rol\": \"user\",\r\n            }\r\n            const req=this.http.post('http://localhost:8080/usuarios/add',body,{}).pipe()\r\n            req.subscribe();\r\n            this.onLogin(email,passwordEncrypted);*/\n            document.getElementById(\"emailRegister\").value = \"\";\n            document.getElementById(\"usernameRegister\").value = \"\";\n            document.getElementById(\"passwordRegister\").value = \"\";\n            _this2._snackBar.open(\"Cuenta creada correctamente\", \"Cerrar\");\n          } else {\n            _this2._snackBar.open(\"Todos los campos deben ser rellenados\", \"Cerrar\");\n          }\n        } else {\n          _this2._snackBar.open(\"Correo ya registrado\", \"Cerrar\");\n        }\n      }\n    })();\n  }\n  getUser(email) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      const req = yield _this3.http.post('http://localhost:8080/usuarios/getEmail', email, {}).pipe();\n      yield req.subscribe(res => {\n        console.log(\"desde metodo: \" + res);\n        return res;\n      });\n    })();\n  }\n  encryptar(palabra) {\n    var hex = shajs('sha256').update(palabra).digest('hex');\n    return hex;\n  }\n  getErrorMessage() {\n    if (this.email.hasError('required')) {\n      return 'Tienes que insertar un correo';\n    }\n    return this.email.hasError('email') ? 'No es un email valido' : '';\n  }\n}\nLoginComponent.ɵfac = function LoginComponent_Factory(t) {\n  return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i3.MatSnackBar), i0.ɵɵdirectiveInject(i4.userService));\n};\nLoginComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: LoginComponent,\n  selectors: [[\"app-login\"]],\n  decls: 35,\n  vars: 4,\n  consts: [[\"href\", \"https://fonts.googleapis.com/css?family=Chewy\", \"rel\", \"stylesheet\"], [1, \"login\"], [\"src\", \"../../assets/login.webp\", \"alt\", \"loginIco\", 1, \"icono\"], [\"for\", \"username\", 1, \"labelLogin\"], [\"type\", \"text\", \"matInput\", \"\", \"id\", \"userName\", \"placeholder\", \"Introduce tu correo:\", \"required\", \"\", 3, \"formControl\"], [\"usernameLogin\", \"\"], [4, \"ngIf\"], [\"for\", \"password\", 1, \"labelLogin\"], [\"type\", \"password\", \"id\", \"password\", \"placeholder\", \"Introduce tu contrase\\u00F1a:\", \"required\", \"\"], [\"passwordLogin\", \"\"], [\"type\", \"button\", 2, \"color\", \"black\", 3, \"click\"], [1, \"register\"], [\"src\", \"../../assets/register.png\", \"alt\", \"registerIco\", 1, \"iconoRegister\"], [\"for\", \"email\", 1, \"labelRegister\"], [\"type\", \"text\", \"matInput\", \"\", \"id\", \"emailRegister\", \"placeholder\", \"Introduce tu correo:\", \"required\", \"\", 3, \"formControl\"], [\"emailRegister\", \"\"], [\"for\", \"username\", 1, \"labelRegister\"], [\"type\", \"text\", \"id\", \"usernameRegister\", \"placeholder\", \"Introduce tu nombre:\", \"required\", \"\"], [\"usernameRegister\", \"\"], [\"for\", \"password\", 1, \"labelRegister\"], [\"type\", \"password\", \"id\", \"passwordRegister\", \"placeholder\", \"Introduce tu contrase\\u00F1a:\", \"required\", \"\"], [\"passwordRegister\", \"\"]],\n  template: function LoginComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      const _r7 = i0.ɵɵgetCurrentView();\n      i0.ɵɵelement(0, \"link\", 0);\n      i0.ɵɵelementStart(1, \"form\", 1);\n      i0.ɵɵelement(2, \"img\", 2);\n      i0.ɵɵelementStart(3, \"h3\");\n      i0.ɵɵtext(4, \"Login\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"label\", 3);\n      i0.ɵɵtext(6, \"Email\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(7, \"input\", 4, 5);\n      i0.ɵɵtemplate(9, LoginComponent_mat_error_9_Template, 2, 1, \"mat-error\", 6);\n      i0.ɵɵelementStart(10, \"label\", 7);\n      i0.ɵɵtext(11, \"Password\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(12, \"input\", 8, 9);\n      i0.ɵɵelementStart(14, \"button\", 10);\n      i0.ɵɵlistener(\"click\", function LoginComponent_Template_button_click_14_listener() {\n        i0.ɵɵrestoreView(_r7);\n        const _r0 = i0.ɵɵreference(8);\n        const _r2 = i0.ɵɵreference(13);\n        return i0.ɵɵresetView(ctx.onLogin(_r0.value, _r2.value));\n      });\n      i0.ɵɵtext(15, \"Log In\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(16, \"form\", 11);\n      i0.ɵɵelement(17, \"img\", 12);\n      i0.ɵɵelementStart(18, \"h3\");\n      i0.ɵɵtext(19, \"Register\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"label\", 13);\n      i0.ɵɵtext(21, \"Email\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(22, \"input\", 14, 15);\n      i0.ɵɵtemplate(24, LoginComponent_mat_error_24_Template, 2, 1, \"mat-error\", 6);\n      i0.ɵɵelementStart(25, \"label\", 16);\n      i0.ɵɵtext(26, \"Username\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(27, \"input\", 17, 18);\n      i0.ɵɵelementStart(29, \"label\", 19);\n      i0.ɵɵtext(30, \"Password\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(31, \"input\", 20, 21);\n      i0.ɵɵelementStart(33, \"button\", 10);\n      i0.ɵɵlistener(\"click\", function LoginComponent_Template_button_click_33_listener() {\n        i0.ɵɵrestoreView(_r7);\n        const _r3 = i0.ɵɵreference(23);\n        const _r5 = i0.ɵɵreference(28);\n        const _r6 = i0.ɵɵreference(32);\n        return i0.ɵɵresetView(ctx.onRegister(_r3.value, _r5.value, _r6.value));\n      });\n      i0.ɵɵtext(34, \"Register\");\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"formControl\", ctx.email);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.pulsadoLogin);\n      i0.ɵɵadvance(13);\n      i0.ɵɵproperty(\"formControl\", ctx.email);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.pulsadoRegister);\n    }\n  },\n  dependencies: [i5.NgIf, i6.MatError, i7.MatInput, i8.ɵNgNoValidate, i8.DefaultValueAccessor, i8.NgControlStatus, i8.NgControlStatusGroup, i8.RequiredValidator, i8.NgForm, i8.FormControlDirective],\n  styles: [\"*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{\\r\\n    padding: 0;\\r\\n    margin: 0;\\r\\n    box-sizing: border-box;\\r\\n}\\r\\n\\r\\n.background[_ngcontent-%COMP%]{\\r\\n    width: 430px;\\r\\n    height: 520px;\\r\\n    position: absolute;\\r\\n    transform: translate(-50%,-50%);\\r\\n    left: 30%;\\r\\n    top: 50%;\\r\\n}\\r\\n.background[_ngcontent-%COMP%]   .shape[_ngcontent-%COMP%]{\\r\\n    height: 200px;\\r\\n    width: 200px;\\r\\n    position: absolute;\\r\\n    border-radius: 50%;\\r\\n}\\r\\n.shape[_ngcontent-%COMP%]:first-child{\\r\\n    background: linear-gradient(\\r\\n        #1845ad,\\r\\n        #23a2f6\\r\\n    );\\r\\n    left: -80px;\\r\\n    top: -80px;\\r\\n}\\r\\n.shape[_ngcontent-%COMP%]:last-child{\\r\\n    background: linear-gradient(\\r\\n        to right,\\r\\n        #ff512f,\\r\\n        #f09819\\r\\n    );\\r\\n    right: -30px;\\r\\n    bottom: -80px;\\r\\n}\\r\\n.login[_ngcontent-%COMP%]{\\r\\n    top: 50%;\\r\\n    left: 30%;\\r\\n}\\r\\n.register[_ngcontent-%COMP%]{\\r\\n    top: 50%;\\r\\n    left: 70%;\\r\\n}\\r\\nform[_ngcontent-%COMP%]{\\r\\n\\r\\n    height: 520px;\\r\\n    width: 400px;\\r\\n    background-color: rgba(255,255,255,0.13);\\r\\n    position: absolute;\\r\\n    transform: translate(-50%,-50%);\\r\\n    border-radius: 10px;\\r\\n    -webkit-backdrop-filter: blur(10px);\\r\\n            backdrop-filter: blur(10px);\\r\\n    border: 2px solid rgba(255,255,255,0.1);\\r\\n    box-shadow: 0 0 40px rgba(8,7,16,0.6);\\r\\n    padding: 35px 35px;\\r\\n}\\r\\nform[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{\\r\\n    \\r\\n    letter-spacing: 0.5px;\\r\\n    outline: none;\\r\\n    border: none;\\r\\n}\\r\\nform[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{\\r\\n    font-family: Chewy;\\r\\n    color:rgb(188, 0, 0);\\r\\n    font-size: 50px;\\r\\n    font-weight: 500;\\r\\n    line-height: 42px;\\r\\n    text-align: center;\\r\\n}\\r\\n.icono[_ngcontent-%COMP%]{\\r\\n    width: 60%;\\r\\n    padding-left: 120px!important;\\r\\n    padding-bottom: 5px!important;\\r\\n    resize: 10% ;\\r\\n}\\r\\n.iconoRegister[_ngcontent-%COMP%]{\\r\\n    width: 70%;\\r\\n    padding-left: 120px!important;\\r\\n    padding-bottom: 5px!important;\\r\\n    resize: 10% ;\\r\\n}\\r\\n.labelLogin[_ngcontent-%COMP%]{\\r\\n    display: block;\\r\\n    margin-top: 30px;\\r\\n    font-size: 16px;\\r\\n    font-weight: 500;\\r\\n}\\r\\n.labelRegister[_ngcontent-%COMP%]{\\r\\n    display: block;\\r\\n    margin-top: 5px;\\r\\n    font-size: 16px;\\r\\n    font-weight: 500;\\r\\n}\\r\\ninput[_ngcontent-%COMP%]{\\r\\n    display: block;\\r\\n    height: 50px;\\r\\n    width: 100%;\\r\\n    background-color: rgba(255,255,255,0.07);\\r\\n    border-radius: 3px;\\r\\n    padding: 0 10px;\\r\\n    margin-top: 8px;\\r\\n    font-size: 14px;\\r\\n    font-weight: 300;\\r\\n}\\r\\n[_ngcontent-%COMP%]::placeholder{\\r\\n    color: black;\\r\\n}\\r\\nbutton[_ngcontent-%COMP%]{\\r\\n    width: 100%;\\r\\n    background-color: #ffffff;\\r\\n    color: #080710;\\r\\n    padding: 15px 0;\\r\\n    font-size: 18px;\\r\\n    font-weight: 600;\\r\\n    border-radius: 5px;\\r\\n    cursor: pointer;\\r\\n}\\r\\n.social[_ngcontent-%COMP%]{\\r\\n  margin-top: 30px;\\r\\n  display: flex;\\r\\n}\\r\\n.social[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{\\r\\n  background: red;\\r\\n  width: 150px;\\r\\n  border-radius: 3px;\\r\\n  padding: 5px 10px 10px 5px;\\r\\n  background-color: rgba(255,255,255,0.27);\\r\\n  color: #eaf0fb;\\r\\n  text-align: center;\\r\\n}\\r\\n.social[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:hover{\\r\\n  background-color: rgba(255,255,255,0.47);\\r\\n}\\r\\n.social[_ngcontent-%COMP%]   .fb[_ngcontent-%COMP%]{\\r\\n  margin-left: 25px;\\r\\n}\\r\\n.social[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{\\r\\n  margin-right: 4px;\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvbG9naW4vbG9naW4uY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0lBR0ksVUFBVTtJQUNWLFNBQVM7SUFDVCxzQkFBc0I7QUFDMUI7O0FBRUE7SUFDSSxZQUFZO0lBQ1osYUFBYTtJQUNiLGtCQUFrQjtJQUNsQiwrQkFBK0I7SUFDL0IsU0FBUztJQUNULFFBQVE7QUFDWjtBQUNBO0lBQ0ksYUFBYTtJQUNiLFlBQVk7SUFDWixrQkFBa0I7SUFDbEIsa0JBQWtCO0FBQ3RCO0FBQ0E7SUFDSTs7O0tBR0M7SUFDRCxXQUFXO0lBQ1gsVUFBVTtBQUNkO0FBQ0E7SUFDSTs7OztLQUlDO0lBQ0QsWUFBWTtJQUNaLGFBQWE7QUFDakI7QUFDQTtJQUNJLFFBQVE7SUFDUixTQUFTO0FBQ2I7QUFDQTtJQUNJLFFBQVE7SUFDUixTQUFTO0FBQ2I7QUFDQTs7SUFFSSxhQUFhO0lBQ2IsWUFBWTtJQUNaLHdDQUF3QztJQUN4QyxrQkFBa0I7SUFDbEIsK0JBQStCO0lBQy9CLG1CQUFtQjtJQUNuQixtQ0FBMkI7WUFBM0IsMkJBQTJCO0lBQzNCLHVDQUF1QztJQUN2QyxxQ0FBcUM7SUFDckMsa0JBQWtCO0FBQ3RCO0FBQ0E7O0lBRUkscUJBQXFCO0lBQ3JCLGFBQWE7SUFDYixZQUFZO0FBQ2hCO0FBQ0E7SUFDSSxrQkFBa0I7SUFDbEIsb0JBQW9CO0lBQ3BCLGVBQWU7SUFDZixnQkFBZ0I7SUFDaEIsaUJBQWlCO0lBQ2pCLGtCQUFrQjtBQUN0QjtBQUNBO0lBQ0ksVUFBVTtJQUNWLDZCQUE2QjtJQUM3Qiw2QkFBNkI7SUFDN0IsWUFBWTtBQUNoQjtBQUNBO0lBQ0ksVUFBVTtJQUNWLDZCQUE2QjtJQUM3Qiw2QkFBNkI7SUFDN0IsWUFBWTtBQUNoQjtBQUNBO0lBQ0ksY0FBYztJQUNkLGdCQUFnQjtJQUNoQixlQUFlO0lBQ2YsZ0JBQWdCO0FBQ3BCO0FBQ0E7SUFDSSxjQUFjO0lBQ2QsZUFBZTtJQUNmLGVBQWU7SUFDZixnQkFBZ0I7QUFDcEI7QUFDQTtJQUNJLGNBQWM7SUFDZCxZQUFZO0lBQ1osV0FBVztJQUNYLHdDQUF3QztJQUN4QyxrQkFBa0I7SUFDbEIsZUFBZTtJQUNmLGVBQWU7SUFDZixlQUFlO0lBQ2YsZ0JBQWdCO0FBQ3BCO0FBQ0E7SUFDSSxZQUFZO0FBQ2hCO0FBQ0E7SUFDSSxXQUFXO0lBQ1gseUJBQXlCO0lBQ3pCLGNBQWM7SUFDZCxlQUFlO0lBQ2YsZUFBZTtJQUNmLGdCQUFnQjtJQUNoQixrQkFBa0I7SUFDbEIsZUFBZTtBQUNuQjtBQUNBO0VBQ0UsZ0JBQWdCO0VBQ2hCLGFBQWE7QUFDZjtBQUNBO0VBQ0UsZUFBZTtFQUNmLFlBQVk7RUFDWixrQkFBa0I7RUFDbEIsMEJBQTBCO0VBQzFCLHdDQUF3QztFQUN4QyxjQUFjO0VBQ2Qsa0JBQWtCO0FBQ3BCO0FBQ0E7RUFDRSx3Q0FBd0M7QUFDMUM7QUFDQTtFQUNFLGlCQUFpQjtBQUNuQjtBQUNBO0VBQ0UsaUJBQWlCO0FBQ25CIiwic291cmNlc0NvbnRlbnQiOlsiKixcclxuKjpiZWZvcmUsXHJcbio6YWZ0ZXJ7XHJcbiAgICBwYWRkaW5nOiAwO1xyXG4gICAgbWFyZ2luOiAwO1xyXG4gICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcclxufVxyXG5cclxuLmJhY2tncm91bmR7XHJcbiAgICB3aWR0aDogNDMwcHg7XHJcbiAgICBoZWlnaHQ6IDUyMHB4O1xyXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwtNTAlKTtcclxuICAgIGxlZnQ6IDMwJTtcclxuICAgIHRvcDogNTAlO1xyXG59XHJcbi5iYWNrZ3JvdW5kIC5zaGFwZXtcclxuICAgIGhlaWdodDogMjAwcHg7XHJcbiAgICB3aWR0aDogMjAwcHg7XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICBib3JkZXItcmFkaXVzOiA1MCU7XHJcbn1cclxuLnNoYXBlOmZpcnN0LWNoaWxke1xyXG4gICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KFxyXG4gICAgICAgICMxODQ1YWQsXHJcbiAgICAgICAgIzIzYTJmNlxyXG4gICAgKTtcclxuICAgIGxlZnQ6IC04MHB4O1xyXG4gICAgdG9wOiAtODBweDtcclxufVxyXG4uc2hhcGU6bGFzdC1jaGlsZHtcclxuICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudChcclxuICAgICAgICB0byByaWdodCxcclxuICAgICAgICAjZmY1MTJmLFxyXG4gICAgICAgICNmMDk4MTlcclxuICAgICk7XHJcbiAgICByaWdodDogLTMwcHg7XHJcbiAgICBib3R0b206IC04MHB4O1xyXG59XHJcbi5sb2dpbntcclxuICAgIHRvcDogNTAlO1xyXG4gICAgbGVmdDogMzAlO1xyXG59XHJcbi5yZWdpc3RlcntcclxuICAgIHRvcDogNTAlO1xyXG4gICAgbGVmdDogNzAlO1xyXG59XHJcbmZvcm17XHJcblxyXG4gICAgaGVpZ2h0OiA1MjBweDtcclxuICAgIHdpZHRoOiA0MDBweDtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LDI1NSwyNTUsMC4xMyk7XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLC01MCUpO1xyXG4gICAgYm9yZGVyLXJhZGl1czogMTBweDtcclxuICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxMHB4KTtcclxuICAgIGJvcmRlcjogMnB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsMC4xKTtcclxuICAgIGJveC1zaGFkb3c6IDAgMCA0MHB4IHJnYmEoOCw3LDE2LDAuNik7XHJcbiAgICBwYWRkaW5nOiAzNXB4IDM1cHg7XHJcbn1cclxuZm9ybSAqe1xyXG4gICAgXHJcbiAgICBsZXR0ZXItc3BhY2luZzogMC41cHg7XHJcbiAgICBvdXRsaW5lOiBub25lO1xyXG4gICAgYm9yZGVyOiBub25lO1xyXG59XHJcbmZvcm0gaDN7XHJcbiAgICBmb250LWZhbWlseTogQ2hld3k7XHJcbiAgICBjb2xvcjpyZ2IoMTg4LCAwLCAwKTtcclxuICAgIGZvbnQtc2l6ZTogNTBweDtcclxuICAgIGZvbnQtd2VpZ2h0OiA1MDA7XHJcbiAgICBsaW5lLWhlaWdodDogNDJweDtcclxuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxufVxyXG4uaWNvbm97XHJcbiAgICB3aWR0aDogNjAlO1xyXG4gICAgcGFkZGluZy1sZWZ0OiAxMjBweCFpbXBvcnRhbnQ7XHJcbiAgICBwYWRkaW5nLWJvdHRvbTogNXB4IWltcG9ydGFudDtcclxuICAgIHJlc2l6ZTogMTAlIDtcclxufVxyXG4uaWNvbm9SZWdpc3RlcntcclxuICAgIHdpZHRoOiA3MCU7XHJcbiAgICBwYWRkaW5nLWxlZnQ6IDEyMHB4IWltcG9ydGFudDtcclxuICAgIHBhZGRpbmctYm90dG9tOiA1cHghaW1wb3J0YW50O1xyXG4gICAgcmVzaXplOiAxMCUgO1xyXG59XHJcbi5sYWJlbExvZ2lue1xyXG4gICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICBtYXJnaW4tdG9wOiAzMHB4O1xyXG4gICAgZm9udC1zaXplOiAxNnB4O1xyXG4gICAgZm9udC13ZWlnaHQ6IDUwMDtcclxufVxyXG4ubGFiZWxSZWdpc3RlcntcclxuICAgIGRpc3BsYXk6IGJsb2NrO1xyXG4gICAgbWFyZ2luLXRvcDogNXB4O1xyXG4gICAgZm9udC1zaXplOiAxNnB4O1xyXG4gICAgZm9udC13ZWlnaHQ6IDUwMDtcclxufVxyXG5pbnB1dHtcclxuICAgIGRpc3BsYXk6IGJsb2NrO1xyXG4gICAgaGVpZ2h0OiA1MHB4O1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwyNTUsMjU1LDAuMDcpO1xyXG4gICAgYm9yZGVyLXJhZGl1czogM3B4O1xyXG4gICAgcGFkZGluZzogMCAxMHB4O1xyXG4gICAgbWFyZ2luLXRvcDogOHB4O1xyXG4gICAgZm9udC1zaXplOiAxNHB4O1xyXG4gICAgZm9udC13ZWlnaHQ6IDMwMDtcclxufVxyXG46OnBsYWNlaG9sZGVye1xyXG4gICAgY29sb3I6IGJsYWNrO1xyXG59XHJcbmJ1dHRvbntcclxuICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjtcclxuICAgIGNvbG9yOiAjMDgwNzEwO1xyXG4gICAgcGFkZGluZzogMTVweCAwO1xyXG4gICAgZm9udC1zaXplOiAxOHB4O1xyXG4gICAgZm9udC13ZWlnaHQ6IDYwMDtcclxuICAgIGJvcmRlci1yYWRpdXM6IDVweDtcclxuICAgIGN1cnNvcjogcG9pbnRlcjtcclxufVxyXG4uc29jaWFse1xyXG4gIG1hcmdpbi10b3A6IDMwcHg7XHJcbiAgZGlzcGxheTogZmxleDtcclxufVxyXG4uc29jaWFsIGRpdntcclxuICBiYWNrZ3JvdW5kOiByZWQ7XHJcbiAgd2lkdGg6IDE1MHB4O1xyXG4gIGJvcmRlci1yYWRpdXM6IDNweDtcclxuICBwYWRkaW5nOiA1cHggMTBweCAxMHB4IDVweDtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwyNTUsMjU1LDAuMjcpO1xyXG4gIGNvbG9yOiAjZWFmMGZiO1xyXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcclxufVxyXG4uc29jaWFsIGRpdjpob3ZlcntcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwyNTUsMjU1LDAuNDcpO1xyXG59XHJcbi5zb2NpYWwgLmZie1xyXG4gIG1hcmdpbi1sZWZ0OiAyNXB4O1xyXG59XHJcbi5zb2NpYWwgaXtcclxuICBtYXJnaW4tcmlnaHQ6IDRweDtcclxufSJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["shajs","FormControl","Validators","i0","LoginComponent","constructor","router","http","_snackBar","userService","required","email","onLogin","password","user","getUser","console","log","pulsadoLogin","mensaje","getErrorMessage","aux","correo","passwordEncrypted","encryptar","document","getElementById","value","setUser","navigate","open","onRegister","username","pulsadoRegister","guardado","req","post","pipe","subscribe","res","palabra","hex","update","digest","hasError","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\Antonio Mallen Gimen\\Documents\\Proyecto\\FrontAntonioMallen\\src\\app\\login\\login.component.ts","C:\\Users\\Antonio Mallen Gimen\\Documents\\Proyecto\\FrontAntonioMallen\\src\\app\\login\\login.component.html"],"sourcesContent":["import { Component/*, Output, EventEmitter */} from '@angular/core';\nimport { Router, UrlSerializer } from '@angular/router';\nimport { HttpClient } from '@angular/common/http';\nimport { User } from '../model/user';\nimport {MatSnackBar} from '@angular/material/snack-bar';\nimport * as shajs from 'sha.js';\nimport { userService } from '../userService';\nimport {FormControl, Validators} from '@angular/forms';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.css']\n})\nexport class LoginComponent {\n  \n  //users: User[]=[];\n  mensaje: String=\"\";\n  email = new FormControl('', [Validators.required, Validators.email]);\n  pulsadoLogin=false\n  pulsadoRegister=false\n  \n  \n  \n  constructor(private router: Router, private http:HttpClient,private _snackBar: MatSnackBar, private userService: userService) {\n    /*const req=this.http.get<User[]>('http://localhost:8080/usuarios/all')\n    req.subscribe(res=>{\n      this.users=res;\n    })*/\n  }\n  async onLogin(email:string,password:string){\n    var user:User| null =await this.getUser(email)\n    console.log(\"Desde el login\"+user)\n\n    this.pulsadoLogin=true;\n    let mensaje=this.getErrorMessage();\n    \n    if(mensaje==''){\n\n      if(email!=\"\" && password !=\"\"){\n        let aux: string=''\n        console.log(user)\n        if(user){\n          console.log(user.correo+\" \"+email + \" \"+ aux)\n          if(user.correo==email && aux!='ok' && aux!='cn'){\n            var passwordEncrypted=this.encryptar(password);\n            \n            if(user.password==passwordEncrypted){\n              aux='ok';\n            }else{\n              aux='cn';\n              \n            }\n          }else{\n            aux='co';\n          }\n          if(aux=='ok'){\n            (<HTMLInputElement>document.getElementById(\"userName\")).value=\"\";\n            (<HTMLInputElement>document.getElementById(\"password\")).value=\"\";\n            \n            this.userService.setUser(user)\n            this.router.navigate(['/home'])\n          }else if(aux=='cn'){\n            this._snackBar.open(\"Contraseña incorrecta\", \"Cerrar\");\n          }else{\n            this._snackBar.open(\"Correo no encontrado\", \"Cerrar\");\n          }\n          console.log(aux+ \" \" + user)\n        }\n        \n      }else{\n        this._snackBar.open(\"Todos los campos deben ser rellenados\", \"Cerrar\");\n      }\n      \n    }\n  }\n  async onRegister(email:string, username:string, password:string){\n    var user:User| null =await this.getUser(email)\n    console.log(user)\n    this.pulsadoRegister=true;\n    let mensaje=this.getErrorMessage();\n    if(mensaje==''){\n      let guardado:boolean=false;\n      if(user){\n        if(user.correo!=null){\n          guardado=true\n        }\n      }\n      if(guardado==false){\n        if(email!=\"\" && username !=\"\" && password !=\"\"){\n          /*\n          var passwordEncrypted=this.encryptar(password);\n          let body={\n            \"nombre\": username,\n            \"correo\": email,\n            \"password\": passwordEncrypted,\n            \"reservas\": [],\n            \"rol\": \"user\",\n          }\n          const req=this.http.post('http://localhost:8080/usuarios/add',body,{}).pipe()\n          req.subscribe();\n          this.onLogin(email,passwordEncrypted);*/\n          \n          (<HTMLInputElement>document.getElementById(\"emailRegister\")).value=\"\";\n          (<HTMLInputElement>document.getElementById(\"usernameRegister\")).value=\"\";\n          (<HTMLInputElement>document.getElementById(\"passwordRegister\")).value=\"\";\n          this._snackBar.open(\"Cuenta creada correctamente\", \"Cerrar\");\n        }else{\n          this._snackBar.open(\"Todos los campos deben ser rellenados\", \"Cerrar\");\n        }\n        \n      }else{\n        this._snackBar.open(\"Correo ya registrado\", \"Cerrar\");\n      }\n    }\n  }\n  \n  async getUser(email:string):Promise<any>{\n    const req=await this.http.post('http://localhost:8080/usuarios/getEmail',email,{}).pipe()\n    await req.subscribe(res=>{\n      console.log(\"desde metodo: \"+res)\n      return res;\n    })\n  }\n  \n  encryptar(palabra:string): string{\n    var hex= shajs('sha256').update(palabra).digest('hex')\n    return hex;\n  }\n  getErrorMessage() {\n    if (this.email.hasError('required')) {\n      return 'Tienes que insertar un correo';\n    }\n    \n    return this.email.hasError('email') ? 'No es un email valido' : '';\n  }\n}\n","<!--<div class=\"background\">\n  <div class=\"shape\"></div>\n  <div class=\"shape\"></div>\n</div>-->\n\n<link href='https://fonts.googleapis.com/css?family=Chewy' rel='stylesheet'>\n  <form class=\"login\">\n    \n    <img class=\"icono\" src=\"../../assets/login.webp\"  alt=\"loginIco\"/>\n    <h3>Login</h3>\n  \n    <label class=\"labelLogin\" for=\"username\">Email</label>\n    <input type=\"text\" matInput id =\"userName\" placeholder=\"Introduce tu correo:\" [formControl]=\"email\" required #usernameLogin>\n    <mat-error *ngIf=\"pulsadoLogin\">{{getErrorMessage()}}</mat-error>\n  \n    <label class=\"labelLogin\" for=\"password\">Password</label>\n    <input type=\"password\" id =\"password\" placeholder=\"Introduce tu contraseña:\" #passwordLogin required>\n  \n    <button type='button' style=\"color: black\" (click)=\"onLogin(usernameLogin.value, passwordLogin.value)\">Log In</button>\n    \n  </form>\n\n  <form class=\"register\">\n    <img class=\"iconoRegister\" src=\"../../assets/register.png\"  alt=\"registerIco\"/>\n    <h3>Register</h3>\n\n    <label class=\"labelRegister\" for=\"email\">Email</label>\n    <input type=\"text\" matInput id =\"emailRegister\" placeholder=\"Introduce tu correo:\" [formControl]=\"email\" #emailRegister required>\n    <mat-error *ngIf=\"pulsadoRegister\">{{getErrorMessage()}}</mat-error>\n  \n    <label class=\"labelRegister\" for=\"username\">Username</label>\n    <input type=\"text\" id =\"usernameRegister\" placeholder=\"Introduce tu nombre:\" #usernameRegister required>\n  \n    <label class=\"labelRegister\" for=\"password\">Password</label>\n    <input type=\"password\" id =\"passwordRegister\" placeholder=\"Introduce tu contraseña:\" #passwordRegister required>\n  \n    <button type='button' style=\"color: black\" (click)=\"onRegister(emailRegister.value, usernameRegister.value, passwordRegister.value)\">Register</button>\n    \n  </form>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}